!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).rwinix={})}(this,(function(t){"use strict";function e(t,n,r,o){var u=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(u,e.prototype),u.expected=n,u.found=r,u.location=o,u.name="SyntaxError",u}function n(t,e,n){return n=n||" ",t.length>e?t:(e-=t.length,t+(n+=n.repeat(e)).slice(0,e))}!function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}(e,Error),e.prototype.format=function(t){var e="Error: "+this.message;if(this.location){var r,o=null;for(r=0;r<t.length;r++)if(t[r].source===this.location.source){o=t[r].text.split(/\r\n|\n|\r/g);break}var u=this.location.start,s=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(u):u,i=this.location.source+":"+s.line+":"+s.column;if(o){var c=this.location.end,l=n("",s.line.toString().length," "),a=o[u.line-1],f=(u.line===c.line?c.column:a.length+1)-u.column||1;e+="\n --\x3e "+i+"\n"+l+" |\n"+s.line+" | "+a+"\n"+l+" | "+n("",u.column-1," ")+n("",f,"^")}else e+="\n at "+i}return e},e.buildMessage=function(t,e){var n={literal:function(t){return'"'+o(t.text)+'"'},class:function(t){var e=t.parts.map((function(t){return Array.isArray(t)?u(t[0])+"-"+u(t[1]):u(t)}));return"["+(t.inverted?"^":"")+e.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description}};function r(t){return t.charCodeAt(0).toString(16).toUpperCase()}function o(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}function u(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}function s(t){return n[t.type](t)}return"Expected "+function(t){var e,n,r=t.map(s);if(r.sort(),r.length>0){for(e=1,n=1;e<r.length;e++)r[e-1]!==r[e]&&(r[n]=r[e],n++);r.length=n}switch(r.length){case 1:return r[0];case 2:return r[0]+" or "+r[1];default:return r.slice(0,-1).join(", ")+", or "+r[r.length-1]}}(t)+" but "+function(t){return t?'"'+o(t)+'"':"end of input"}(e)+" found."};const r=function(t,n){var r,o={},u=(n=void 0!==n?n:{}).grammarSource,s={Source:St},i=St,c="\n",l="[",a="]",f=":",h='"""',p='"',d='""',A="'''",g="'",m="''",x="#",b=/^[^\n]/,y=/^[^[\]\n]/,v=/^[^:\n]/,P=/^[^\n#('"' &'""')]/,w=/^[^\n('"' &'""')]/,C=/^[^"]/,k=/^[^\n#("'" &"''")]/,_=/^[^']/,T=/^[^\n#]/,j=/^[^ \t\n[#]/,O=/^[ \t\n]/,F=/^[ \t]/,U=jt("\n",!1),E=Ot(["\n"],!0,!1),S=jt("[",!1),R=Ot(["[","]","\n"],!0,!1),W=jt("]",!1),M=Ot([":","\n"],!0,!1),q=jt(":",!1),z=Ot(["\n","#","(","'",'"',"'"," ","&","'",'"','"',"'",")"],!0,!1),B=Ot(["\n","(","'",'"',"'"," ","&","'",'"','"',"'",")"],!0,!1),D=jt('"""',!1),G=jt('"',!1),H=jt('""',!1),I=Ot(['"'],!0,!1),J=Ot(["\n","#","(",'"',"'",'"'," ","&",'"',"'","'",'"',")"],!0,!1),K=jt("'''",!1),L=jt("'",!1),N=jt("''",!1),Q=Ot(["'"],!0,!1),V=Ot(["\n","#"],!0,!1),X=Ot([" ","\t","\n","[","#"],!0,!1),Y=jt("#",!1),Z=Ot([" ","\t","\n"],!1,!1),$=Ot([" ","\t"],!1,!1),tt={type:"any"},et=function(t){return{nodeType:"rwini",blocks:t.filter((t=>t))}},nt=function(t){return t},rt=function(){return Tt(n.errors["line.unknown"])},ot=function(t,e,r){if(t.startsWith("comment_"))return{nodeType:"comment_block",content:kt(),location:_t()};for(const t of r)if(t&&"section_item_unknown_line"===t.nodeType)return Tt(n.errors["line.unknown"],t.location);return Object.assign({nodeType:"section",head:t,body:r.filter((t=>t)),location:_t()},e&&{comment:e})},ut=function(t,e){return t.startsWith("comment_")?{nodeType:"comment_block",content:kt(),location:_t()}:Object.assign({nodeType:"section",head:t,body:[],location:_t()},e&&{comment:e})},st=function(t,e){return"]"!=e?Tt(n.errors["section.head.unclosed"]):t||Tt(n.errors["section.head.empty"])},it=function(t,e){return[t,...e.map((t=>t[3])).filter((t=>t))]},ct=function(t,e){return Object.assign(Object.assign({nodeType:"section_item",attr:t},e&&{comment:e}),{location:_t()})},lt=function(t){return{nodeType:"section_item",comment:t,location:_t()}},at=function(t){return{nodeType:"section_item_unknown_line",unknown:t,location:_t()}},ft=function(){},ht=function(t,e){return t?e?{nodeType:"attribute",key:t,value:e.replaceAll("\n",""),location:_t()}:Tt(n.errors["attribute.value.empty"]):Tt(n.errors["attribute.key.empty"])},pt=function(t,e,r,o){return'"""'!=r?Tt(n.errors["attribute.value.multiline.unclosed"]):(t||"")+(e||"")+(o||"")},dt=function(t,e,r,o){return"'''"!=r?Tt(n.errors["attribute.value.multiline.unclosed"]):(t||"")+(e||"")+(o||"")},At=function(t){return t.endsWith('"""')||t.endsWith("'''")?Tt(n.errors["attribute.value.multiline.unclosed"]):t},gt=function(t){return{nodeType:"unknown_line",content:t,location:_t()}},mt=function(t){return{nodeType:"comment_line",content:t,location:_t()}},xt=0,bt=0,yt=[{line:1,column:1}],vt=0,Pt=[],wt=0,Ct={};if("startRule"in n){if(!(n.startRule in s))throw new Error("Can't start parsing from rule \""+n.startRule+'".');i=s[n.startRule]}function kt(){return t.substring(bt,xt)}function _t(){return Ut(bt,xt)}function Tt(t,n){throw function(t,n){return new e(t,null,null,n)}(t,n=void 0!==n?n:Ut(bt,xt))}function jt(t,e){return{type:"literal",text:t,ignoreCase:e}}function Ot(t,e,n){return{type:"class",parts:t,inverted:e,ignoreCase:n}}function Ft(e){var n,r=yt[e];if(r)return r;for(n=e-1;!yt[n];)n--;for(r={line:(r=yt[n]).line,column:r.column};n<e;)10===t.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return yt[e]=r,r}function Ut(t,e,n){var r=Ft(t),o=Ft(e),s={source:u,start:{offset:t,line:r.line,column:r.column},end:{offset:e,line:o.line,column:o.column}};return n&&u&&"function"==typeof u.offset&&(s.start=u.offset(s.start),s.end=u.offset(s.end)),s}function Et(t){xt<vt||(xt>vt&&(vt=xt,Pt=[]),Pt.push(t))}function St(){var t,e,n,r,u=13*xt+0,s=Ct[u];if(s)return xt=s.nextPos,s.result;for(t=xt,e=[],n=xt,Bt(),(r=Rt())!==o?(Bt(),n=r):(xt=n,n=o);n!==o;)e.push(n),n=xt,Bt(),(r=Rt())!==o?(Bt(),n=r):(xt=n,n=o);return(n=Gt())!==o?(bt=t,t=et(e)):(xt=t,t=o),Ct[u]={nextPos:xt,result:t},t}function Rt(){var e,n,r,u,s,i=13*xt+1,l=Ct[i];if(l)return xt=l.nextPos,l.result;if(e=xt,(n=zt())!==o?(10===t.charCodeAt(xt)?(r=c,xt++):(r=o,0===wt&&Et(U)),r===o&&(r=Gt()),r!==o?(bt=e,e=nt(n)):(xt=e,e=o)):(xt=e,e=o),e===o&&(e=function(){var e,n,r,u,s,i,l=13*xt+2,a=Ct[l];if(a)return xt=a.nextPos,a.result;e=xt,n=Wt(),n!==o?(r=Dt(),(u=zt())===o&&(u=null),Dt(),10===t.charCodeAt(xt)?(s=c,xt++):(s=o,0===wt&&Et(U)),s!==o?(Bt(),i=function(){var e,n,r,u,s,i,l,a,f=13*xt+4,h=Ct[f];if(h)return xt=h.nextPos,h.result;if(e=xt,n=Mt(),n!==o){for(r=[],u=xt,s=Dt(),10===t.charCodeAt(xt)?(i=c,xt++):(i=o,0===wt&&Et(U)),i!==o?(l=Dt(),(a=Mt())!==o?u=s=[s,i,l,a]:(xt=u,u=o)):(xt=u,u=o);u!==o;)r.push(u),u=xt,s=Dt(),10===t.charCodeAt(xt)?(i=c,xt++):(i=o,0===wt&&Et(U)),i!==o?(l=Dt(),(a=Mt())!==o?u=s=[s,i,l,a]:(xt=u,u=o)):(xt=u,u=o);bt=e,e=it(n,r)}else xt=e,e=o;return Ct[f]={nextPos:xt,result:e},e}(),i!==o?(bt=e,e=ot(n,u,i)):(xt=e,e=o)):(xt=e,e=o)):(xt=e,e=o);e===o&&(e=xt,(n=Wt())!==o?((r=zt())===o&&(r=null),u=Bt(),Gt()!==o?(bt=e,e=ut(n,r)):(xt=e,e=o)):(xt=e,e=o));return Ct[l]={nextPos:xt,result:e},e}(),e===o)){if(e=xt,n=xt,r=xt,u=[],b.test(t.charAt(xt))?(s=t.charAt(xt),xt++):(s=o,0===wt&&Et(E)),s!==o)for(;s!==o;)u.push(s),b.test(t.charAt(xt))?(s=t.charAt(xt),xt++):(s=o,0===wt&&Et(E));else u=o;u!==o?(10===t.charCodeAt(xt)?(s=c,xt++):(s=o,0===wt&&Et(U)),s===o&&(s=Gt()),s!==o?r=u=[u,s]:(xt=r,r=o)):(xt=r,r=o),(n=r!==o?t.substring(n,xt):r)!==o&&(bt=e,n=rt()),e=n}return Ct[i]={nextPos:xt,result:e},e}function Wt(){var e,n,r,u,s,i=13*xt+3,c=Ct[i];if(c)return xt=c.nextPos,c.result;if(e=xt,91===t.charCodeAt(xt)?(n=l,xt++):(n=o,0===wt&&Et(S)),n!==o){if(r=xt,u=[],y.test(t.charAt(xt))?(s=t.charAt(xt),xt++):(s=o,0===wt&&Et(R)),s!==o)for(;s!==o;)u.push(s),y.test(t.charAt(xt))?(s=t.charAt(xt),xt++):(s=o,0===wt&&Et(R));else u=o;u===o&&(u=null),r=t.substring(r,xt),93===t.charCodeAt(xt)?(u=a,xt++):(u=o,0===wt&&Et(W)),u===o&&(u=null),bt=e,e=st(r,u)}else xt=e,e=o;return Ct[i]={nextPos:xt,result:e},e}function Mt(){var e,n,r,u=13*xt+5,s=Ct[u];return s?(xt=s.nextPos,s.result):(e=xt,n=function(){var e,n,r,u,s,i=13*xt+6,c=Ct[i];if(c)return xt=c.nextPos,c.result;e=xt,n=xt,r=[],v.test(t.charAt(xt))?(u=t.charAt(xt),xt++):(u=o,0===wt&&Et(M));if(u!==o)for(;u!==o;)r.push(u),v.test(t.charAt(xt))?(u=t.charAt(xt),xt++):(u=o,0===wt&&Et(M));else r=o;r===o&&(r=null);n=t.substring(n,xt),58===t.charCodeAt(xt)?(r=f,xt++):(r=o,0===wt&&Et(q));r!==o?(u=Dt(),(s=qt())===o&&(s=null),bt=e,e=ht(n,s)):(xt=e,e=o);return Ct[i]={nextPos:xt,result:e},e}(),n!==o?((r=zt())===o&&(r=null),bt=e,e=ct(n,r)):(xt=e,e=o),e===o&&(e=xt,(n=zt())!==o&&(bt=e,n=lt(n)),(e=n)===o&&(e=xt,n=function(){var e,n,r,u,s,i,c=13*xt+8,l=Ct[c];if(l)return xt=l.nextPos,l.result;e=xt,n=xt,r=xt,j.test(t.charAt(xt))?(u=t.charAt(xt),xt++):(u=o,0===wt&&Et(X));if(u!==o){for(s=[],b.test(t.charAt(xt))?(i=t.charAt(xt),xt++):(i=o,0===wt&&Et(E));i!==o;)s.push(i),b.test(t.charAt(xt))?(i=t.charAt(xt),xt++):(i=o,0===wt&&Et(E));r=u=[u,s]}else xt=r,r=o;n=r!==o?t.substring(n,xt):r;n!==o&&(bt=e,n=gt(n));return e=n,Ct[c]={nextPos:xt,result:e},e}(),n!==o&&(bt=e,n=at(n)),(e=n)===o&&(e=xt,n=Dt(),bt=e,e=n=ft()))),Ct[u]={nextPos:xt,result:e},e)}function qt(){var e,n,r,u,s,i,c,l,a,f=13*xt+7,x=Ct[f];if(x)return xt=x.nextPos,x.result;if(e=xt,n=xt,r=xt,P.test(t.charAt(xt))?(u=t.charAt(xt),xt++):(u=o,0===wt&&Et(z)),u!==o){for(s=[],w.test(t.charAt(xt))?(i=t.charAt(xt),xt++):(i=o,0===wt&&Et(B));i!==o;)s.push(i),w.test(t.charAt(xt))?(i=t.charAt(xt),xt++):(i=o,0===wt&&Et(B));r=u=[u,s]}else xt=r,r=o;if(r===o&&(r=null),n=t.substring(n,xt),t.substr(xt,3)===h?(r=h,xt+=3):(r=o,0===wt&&Et(D)),r!==o){for(u=xt,s=[],i=xt,34===t.charCodeAt(xt)?(c=p,xt++):(c=o,0===wt&&Et(G)),c!==o?(l=xt,wt++,t.substr(xt,2)===d?(a=d,xt+=2):(a=o,0===wt&&Et(H)),wt--,a===o?l=void 0:(xt=l,l=o),l!==o?i=c=[c,l]:(xt=i,i=o)):(xt=i,i=o),i===o&&(C.test(t.charAt(xt))?(i=t.charAt(xt),xt++):(i=o,0===wt&&Et(I)));i!==o;)s.push(i),i=xt,34===t.charCodeAt(xt)?(c=p,xt++):(c=o,0===wt&&Et(G)),c!==o?(l=xt,wt++,t.substr(xt,2)===d?(a=d,xt+=2):(a=o,0===wt&&Et(H)),wt--,a===o?l=void 0:(xt=l,l=o),l!==o?i=c=[c,l]:(xt=i,i=o)):(xt=i,i=o),i===o&&(C.test(t.charAt(xt))?(i=t.charAt(xt),xt++):(i=o,0===wt&&Et(I)));u=t.substring(u,xt),s=xt,t.substr(xt,3)===h?(i=h,xt+=3):(i=o,0===wt&&Et(D)),i===o&&(i=null),s=t.substring(s,xt),(i=qt())===o&&(i=null),bt=e,e=pt(n,u,s,i)}else xt=e,e=o;if(e===o){if(e=xt,n=xt,r=xt,k.test(t.charAt(xt))?(u=t.charAt(xt),xt++):(u=o,0===wt&&Et(J)),u!==o){for(s=[],b.test(t.charAt(xt))?(i=t.charAt(xt),xt++):(i=o,0===wt&&Et(E));i!==o;)s.push(i),b.test(t.charAt(xt))?(i=t.charAt(xt),xt++):(i=o,0===wt&&Et(E));r=u=[u,s]}else xt=r,r=o;if(r===o&&(r=null),n=t.substring(n,xt),t.substr(xt,3)===A?(r=A,xt+=3):(r=o,0===wt&&Et(K)),r!==o){for(u=xt,s=[],i=xt,39===t.charCodeAt(xt)?(c=g,xt++):(c=o,0===wt&&Et(L)),c!==o?(l=xt,wt++,t.substr(xt,2)===m?(a=m,xt+=2):(a=o,0===wt&&Et(N)),wt--,a===o?l=void 0:(xt=l,l=o),l!==o?i=c=[c,l]:(xt=i,i=o)):(xt=i,i=o),i===o&&(_.test(t.charAt(xt))?(i=t.charAt(xt),xt++):(i=o,0===wt&&Et(Q)));i!==o;)s.push(i),i=xt,39===t.charCodeAt(xt)?(c=g,xt++):(c=o,0===wt&&Et(L)),c!==o?(l=xt,wt++,t.substr(xt,2)===m?(a=m,xt+=2):(a=o,0===wt&&Et(N)),wt--,a===o?l=void 0:(xt=l,l=o),l!==o?i=c=[c,l]:(xt=i,i=o)):(xt=i,i=o),i===o&&(_.test(t.charAt(xt))?(i=t.charAt(xt),xt++):(i=o,0===wt&&Et(Q)));u=t.substring(u,xt),s=xt,t.substr(xt,3)===A?(i=A,xt+=3):(i=o,0===wt&&Et(K)),i===o&&(i=null),s=t.substring(s,xt),(i=qt())===o&&(i=null),bt=e,e=dt(n,u,s,i)}else xt=e,e=o;if(e===o){if(e=xt,n=xt,r=[],T.test(t.charAt(xt))?(u=t.charAt(xt),xt++):(u=o,0===wt&&Et(V)),u!==o)for(;u!==o;)r.push(u),T.test(t.charAt(xt))?(u=t.charAt(xt),xt++):(u=o,0===wt&&Et(V));else r=o;(n=r!==o?t.substring(n,xt):r)!==o&&(bt=e,n=At(n)),e=n}}return Ct[f]={nextPos:xt,result:e},e}function zt(){var e,n,r,u,s,i=13*xt+9,c=Ct[i];if(c)return xt=c.nextPos,c.result;if(e=xt,35===t.charCodeAt(xt)?(n=x,xt++):(n=o,0===wt&&Et(Y)),n!==o){for(r=xt,u=[],b.test(t.charAt(xt))?(s=t.charAt(xt),xt++):(s=o,0===wt&&Et(E));s!==o;)u.push(s),b.test(t.charAt(xt))?(s=t.charAt(xt),xt++):(s=o,0===wt&&Et(E));r=t.substring(r,xt),bt=e,e=mt(r)}else xt=e,e=o;return Ct[i]={nextPos:xt,result:e},e}function Bt(){var e,n,r=13*xt+10,u=Ct[r];if(u)return xt=u.nextPos,u.result;for(e=[],O.test(t.charAt(xt))?(n=t.charAt(xt),xt++):(n=o,0===wt&&Et(Z));n!==o;)e.push(n),O.test(t.charAt(xt))?(n=t.charAt(xt),xt++):(n=o,0===wt&&Et(Z));return Ct[r]={nextPos:xt,result:e},e}function Dt(){var e,n,r=13*xt+11,u=Ct[r];if(u)return xt=u.nextPos,u.result;for(e=[],F.test(t.charAt(xt))?(n=t.charAt(xt),xt++):(n=o,0===wt&&Et($));n!==o;)e.push(n),F.test(t.charAt(xt))?(n=t.charAt(xt),xt++):(n=o,0===wt&&Et($));return Ct[r]={nextPos:xt,result:e},e}function Gt(){var e,n,r=13*xt+12,u=Ct[r];return u?(xt=u.nextPos,u.result):(e=xt,wt++,t.length>xt?(n=t.charAt(xt),xt++):(n=o,0===wt&&Et(tt)),wt--,n===o?e=void 0:(xt=e,e=o),Ct[r]={nextPos:xt,result:e},e)}if(n.errors=Object.assign({"line.unknown":"Unknown line.","section.head.empty":"Unexpeted empty section head.","section.head.unclosed":"Unclosed section head.","attribute.key.empty":"Unexpected empty attribute key.","attribute.value.empty":"Unexpected empty attribute value.","attribute.value.multiline.unclosed":"Unclosed attribute multiline value.","attribute.value.multiline.suffix":"Unexpected attribute multiline value suffix"},n.errors),(r=i())!==o&&xt===t.length)return r;throw r!==o&&xt<t.length&&Et({type:"end"}),function(t,n,r){return new e(e.buildMessage(t,n),t,n,r)}(Pt,vt<t.length?t.charAt(vt):null,vt<t.length?Ut(vt,vt+1):Ut(vt,vt))},o=()=>(t,e)=>r(e.content);function u(t,e,n){const r=e(n);function o(e){const n=t(e);return r(n,e)}return{use:(t,e)=>u(o,t,e),process:o}}const s=t=>u((t=>{}),o,t);t.default=s,t.rwini=s,Object.defineProperty(t,"__esModule",{value:!0})}));
